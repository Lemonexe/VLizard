import numpy as np
from .autocorrelation import durbin_watson, von_neumann

# linear line values (total autocorrelation)
fixture_linear_positive = np.linspace(-22, +22, num=55)
fixture_linear_negative = np.linspace(17, 3, num=66)
abs_tol_lin = 0.01  # expected to be quite perfect

# eighty uniformly distributed random numbers from -1 to 1
fixture_random = np.array([
    -0.67482691, -0.43274817, -0.97251141, 0.91988059, -0.06952046, -0.77040369, 0.60241155, 0.67519574, -0.25041782,
    -0.44682111, 0.25154558, -0.91168376, 0.9325723, -0.79796284, -0.56961458, -0.01613706, 0.68427971, 0.01199423,
    -0.00322091, -0.43065338, 0.88114138, 0.61438916, -0.92837074, 0.66632077, 0.13442894, 0.31370284, -0.50510185,
    -0.68503699, 0.54799735, 0.47653323, 0.28809503, -0.65894274, 0.24749319, -0.98875528, 0.22325087, -0.46994332,
    -0.60313383, -0.21261571, 0.50121426, 0.71197364, 0.94818798, -0.18359321, -0.57596357, -0.12097972, -0.86136129,
    0.08387095, -0.81749608, 0.42327689, -0.54374352, -0.28556685, -0.88639055, 0.4693516, 0.48522762, -0.95153458,
    -0.86466616, -0.851383, 0.52477354, 0.45572589, -0.74852584, -0.43819747, -0.66583052, -0.74762218, 0.16012359,
    0.41328767, 0.78783729, -0.81169273, -0.90443799, -0.92220965, 0.12488641, 0.13438501, 0.48523808, 0.72180529,
    0.10252976, 0.55373107, -0.63173151, -0.50977218, 0.61759707, 0.49393917, 0.41964565, -0.88673676
])

# eighty normally distributed random values around 0
fixture_random_normal = np.array([
    9.6916292, -8.63035196, -0.59285016, 4.58467265, 3.13376458, 5.30131598, -0.89014362, 4.85150178, 4.79012673,
    9.73135932, -7.6852038, 0.81596105, 2.77770442, 2.6698059, -16.48516799, -4.86401419, 9.38302629, 6.47653166,
    6.42111208, -0.54583102, -7.98514771, 3.31529347, -17.23178259, -7.93333819, -21.84044173, 10.33690827, 0.87257204,
    -14.88513405, 4.17977456, 1.58527008, -10.92527602, 5.9887354, 1.37464468, 6.81222257, 8.0432328, 4.42235927,
    0.02755671, 2.59671375, 13.04523191, 1.98064826, 1.12507277, -5.92800438, 4.05795842, 8.28798743, 8.18433123,
    1.69290887, -17.51148073, 8.73852803, 13.64271197, 3.65682386, -13.82838471, -0.09620448, -1.32355496, -11.35189136,
    -7.00516931, -1.38165354, 8.35371138, 10.37544152, -5.54930733, 7.86571646, 7.75776475, -3.55495286, 2.53518273,
    -5.15723916, 3.34055586, -9.14581437, 8.71498953, 2.49645142, 1.14788911, 5.02494538
])

abs_tol_rnd = 0.1  # quite high tolerance because these fixtures are crude


def test_durbin_watson():
    print("\n")
    assert abs(0 - durbin_watson(fixture_linear_positive)) < abs_tol_lin
    assert abs(0 - durbin_watson(fixture_linear_negative)) < abs_tol_lin
    assert abs(2 - durbin_watson(fixture_random)) < abs_tol_rnd
    assert abs(2 - durbin_watson(fixture_random_normal)) < abs_tol_rnd


def test_von_neumann():
    assert abs(0 - von_neumann(fixture_linear_positive)) < abs_tol_lin
    assert abs(0 - von_neumann(fixture_linear_negative)) < abs_tol_lin
    assert abs(2 - von_neumann(fixture_random)) < abs_tol_rnd
    assert abs(2 - von_neumann(fixture_random_normal)) < abs_tol_rnd
